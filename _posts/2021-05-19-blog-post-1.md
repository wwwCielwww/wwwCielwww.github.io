---
title: 'Study Notes: GNN Part (I) ðŸŒ² Group Theory & PyG Usage'
date: 2021-06-15
permalink: /posts/2021/06/gnn-1/
categories:
  - Computer Science
tags:
  - GNN

---

# Study Notes: GNN Part (I) ðŸŒ² Group Theory & PyG Usage

## Assignment

```python
from torch_geometric.data import Data
import torch


class Paper(Data):
    """An object modeling a single graph for some Institute-Author-Paper network,
    inherited from torch.geometric.data.Data:

    Args:
        x_institute (Tensor): Node (of type "institute") feature matrix with shape 
            :obj:`[num_nodes, num_node_features]`. 
        x_author (Tensor): Node (of type "author") feature matrix with shape 
            :obj:`[num_nodes, num_node_features]`. 
        x_paper (Tensor): Node (of type "paper") feature matrix with shape 
            :obj:`[num_nodes, num_node_features]`. 
        edge_author_institute (Tensor): Graph connectivity (of type "Author-Institute" 
            in COO format with shape :obj:`[2, num_edges]`. 
        edge_author_paper (Tensor): Graph connectivity (of type "Author-Paper" 
            in COO format with shape :obj:`[2, num_edges]`. 
        y (Tensor, optional): Graph or node targets with arbitrary shape.
            (default: :obj:`None`)
    """
    def __init__(self, x_institute, x_author, x_paper, edge_author_institute, edge_author_paper, y=None):
        super().__init__(
            x_institute=x_institute, 
            x_author=x_author, 
            x_paper=x_paper,
            edge_author_institute=edge_author_institute,
            edge_author_paper=edge_author_paper,
            y=y
        )

    def find_institute_num(self):
        return self.x_institute.shape[0]

    def find_author_num(self):
        return self.x_author.shape[0]

    def find_paper_num(self):
        return self.x_paper.shape[0]


x_institute = torch.rand(5, 6)
x_author = torch.rand(7, 8)
x_paper = torch.rand(9, 10)
edge_author_institute = torch.randint(1, 6, (2, 10))
edge_author_paper = torch.randint(1, 8, (2, 15))
y = torch.rand(30, 30)

data = Paper(x_institute, x_author, x_paper, edge_author_institute, edge_author_paper, y)
print(data)
print("No.Nodes (Institute):", data.find_institute_num())
print("No.Nodes (Author):", data.find_author_num())
print("No.Nodes (Paper):", data.find_paper_num())
```

